"use strict";import{defineComponent as ae,mergeModels as le,useModel as te,ref as C,computed as V,reactive as re,watch as U,onMounted as oe,openBlock as m,createElementBlock as f,withModifiers as q,normalizeClass as p,unref as u,createElementVNode as r,normalizeStyle as B,createCommentVNode as A,withDirectives as S,vModelText as z,Fragment as G,renderList as X,toDisplayString as Y}from"vue";import{twMerge as v}from"tailwind-merge";const se={class:"relative h-36 w-full"},ne={class:"flex gap-3 items-center w-full"},ue={class:"flex-1 space-y-3"},de={class:"relative w-full h-5"},ie={class:"flex items-center justify-between gap-3"},ce={class:"relative flex-1 flex-grow"},pe=["value"],ve={class:"flex space-x-1 items-center"},he=["onUpdate:modelValue"],ge={class:"absolute -top-1.5 left-1 font-bold text-xs leading-none"},me={class:"relative"},fe={key:0,class:"w-full"},be={class:"text-sm mb-2 opacity-80 leading-none"},xe={class:"grid grid-cols-8 gap-2"},ye=["onClick"],we=["onClick"],Me=ae({__name:"ColorPicker",props:le({showPalette:{type:Boolean,default:!0},showEyeDropper:{type:Boolean,default:!0},colorClasses:{default:()=>({surface:"bg-gray-50 dark:bg-black dark:text-white",canvas:"outline-gray-200 dark:outline-gray-800",canvasCircle:"dark:border-white shadow-black",opacityWrapper:"opacity-wrapper",input:"border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-black text-gray-900 dark:text-white",paletteRemove:"bg-red-200 dark:bg-red-700",paletteAdd:"border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-900"})}},{modelValue:{default:"#FF0000"},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const x=te(_,"modelValue"),F=_,h=C(),T=C(),N=C(100),g=V({get:()=>N.value,set:a=>N.value=Math.max(0,Math.min(100,parseInt(a)))}),y=C(!1),E=C({x:0,y:0}),d=re({h:0,s:100,l:100}),w=V({get:()=>b.hslToRgb(d),set:a=>R(b.rgbToHexHsl(a))}),I=V(()=>b.rgbToHex(w.value)),Z=V(()=>I.value.slice(0,7)),P=()=>{if(!x.value)return;let a=x.value;if(a.startsWith("rgba")){const e=a.match(/rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d+(\.\d+)?)\)/);e&&(g.value=100*parseFloat(e[4]),w.value={r:parseInt(e[1]),g:parseInt(e[2]),b:parseInt(e[3])})}else L(a,!0),K()},K=()=>{if(!T.value||!h.value)return;const a=h.value.width,e=h.value.height,t=T.value.createImageData(a,e);for(let l=0;l<e;l++)for(let o=0;o<a;o++){const c=o/a*100,s=100-l/e*100,i=b.hslToRgb({h:d.h,s:c,l:s}),n=4*(l*a+o);t.data[n]=i.r,t.data[n+1]=i.g,t.data[n+2]=i.b,t.data[n+3]=255}T.value.putImageData(t,0,0)},Q=a=>{y.value=!0,j(a),document.addEventListener("mousemove",W),document.addEventListener("mouseup",D)},D=a=>{a.type==="mouseup"&&(y.value=!1,document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",D))},W=a=>{y.value&&j(a)},j=a=>{if(!y.value||!h.value)return;const e=h.value.getBoundingClientRect(),t=Math.max(0,Math.min(a.clientX-e.left,e.width)),l=Math.max(0,Math.min(a.clientY-e.top,e.height));d.s=t/e.width*100,d.l=100-l/e.height*100,E.value={x:d.s,y:100-d.l},M()},$=()=>{requestAnimationFrame(()=>{x.value=I.value})},M=function(){let a;return function(){a&&clearTimeout(a),a=setTimeout(()=>$(),10)}}(),b={hslToRgb:a=>{const e=a.h/60,t=a.s/100,l=a.l/100,o=Math.floor(e),c=e-o,s=l*(1-t),i=l*(1-t*c),n=l*(1-t*(1-c));switch(o%6){case 0:return{r:Math.round(255*l),g:Math.round(255*n),b:Math.round(255*s)};case 1:return{r:Math.round(255*i),g:Math.round(255*l),b:Math.round(255*s)};case 2:return{r:Math.round(255*s),g:Math.round(255*l),b:Math.round(255*n)};case 3:return{r:Math.round(255*s),g:Math.round(255*i),b:Math.round(255*l)};case 4:return{r:Math.round(255*n),g:Math.round(255*s),b:Math.round(255*l)};case 5:return{r:Math.round(255*l),g:Math.round(255*s),b:Math.round(255*i)};default:return{r:0,g:0,b:0}}},_toHex:a=>{const e=Math.round(a).toString(16);return e.length===1?"0"+e:e},rgbToHex:a=>{const e=b._toHex,t=g.value/100,l=t<1?e(Math.round(255*t)):"";return`#${e(a.r)}${e(a.g)}${e(a.b)}${l}`.toUpperCase()},hexToHsl:a=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(a);if(!e)return[{h:0,s:100,l:100},100];const t=parseInt(e[1],16)/255,l=parseInt(e[2],16)/255,o=parseInt(e[3],16)/255,c=e[4]?parseInt(e[4],16)/255:1,s=Math.max(t,l,o),i=Math.min(t,l,o);let n=0;const k=s-i;return s===i?n=0:(s===t?n=(l-o)/k+(l<o?6:0):s===l?n=(o-t)/k+2:s===o&&(n=(t-l)/k+4),n/=6),[{h:360*n,s:100*(s===0?0:k/s),l:100*s},100*c]},rgbToHexHsl:a=>{const{r:e,g:t,b:l}=a,o=Math.max(e,t,l),c=Math.min(e,t,l);let s=0;const i=o/255,n=o-c,k=o===0?0:n/o;if(o===c)s=0;else{switch(o){case e:s=(t-l)/n+(t<l?6:0);break;case t:s=(l-e)/n+2;break;case l:s=(e-t)/n+4}s/=6}return{h:360*s,s:100*k,l:100*i}}},R=(a,e=g.value)=>{g.value=e,d.h=a.h,d.s=a.s,d.l=a.l},L=(a,e=!1)=>{if(!e&&a==x.value)return;const[t,l]=b.hexToHsl(a);R(t,l),!e&&$()},O=()=>{const a=b.rgbToHexHsl(w.value);R(a),$()},J=F.showEyeDropper&&"EyeDropper"in window?window.EyeDropper:void 0,ee=async()=>{const a=J();try{const{sRGBHex:e}=await a.open();L(e)}catch{}};U(d,M),U(x,()=>P()),U(d,()=>{y.value||(E.value={x:d.s,y:100-d.l})}),oe(()=>{h.value&&(T.value=h.value.getContext("2d")??void 0,P())});const H=F.showPalette?function(){const a="color-picker-palette",e=localStorage.getItem(a),t=C(e?JSON.parse(e):[]),l=()=>localStorage.setItem(a,JSON.stringify(t.value));return{colors:t,add:o=>{t.value.includes(o)||(t.value.push(o),l())},remove:o=>{t.value=t.value.filter(c=>c!==o),l()}}}():void 0;return(a,e)=>{var t;return m(),f("form",{onSubmit:e[7]||(e[7]=q(()=>{},["prevent"])),class:p([u(v)("color-picker w-72 flex flex-col gap-4 items-center p-4 rounded-lg shadow-md",a.colorClasses.surface),{"select-none":y.value}])},[r("div",se,[r("canvas",{ref_key:"canvas",ref:h,onMousedown:Q,onMouseup:D,class:p(u(v)("shadow cursor-crosshair rounded-md w-full h-full outline outline-1",(t=a.colorClasses)==null?void 0:t.canvas))},null,34),r("div",{class:p(u(v)("absolute w-4 h-4 border-4  rounded-full shadow-sm pointer-events-none",a.colorClasses.canvasCircle)),style:B({left:`${E.value.x}%`,top:`${E.value.y}%`,transform:"translate(-50%, -50%)"})},null,6)]),r("div",ne,[u(J)?(m(),f("button",{key:0,onClick:ee,class:"grid place-items-center"},e[8]||(e[8]=[r("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24"},[r("path",{fill:"currentColor",d:"m19.35 11.72l-2.13 2.13l-1.41-1.42l-7.71 7.71L3.5 22L2 20.5l1.86-4.6l7.71-7.71l-1.42-1.41l2.13-2.13zM16.76 3A3 3 0 0 1 21 3a3 3 0 0 1 0 4.24l-1.92 1.92l-4.24-4.24zM5.56 17.03L4.5 19.5l2.47-1.06L14.4 11L13 9.6z"})],-1)]))):A("",!0),r("div",{class:p(u(v)("opacity-wrapper w-7 h-7",a.colorClasses.opacityWrapper))},[r("div",{class:"w-7 h-7",style:B({backgroundColor:I.value})},null,4)],2),r("div",ue,[r("div",de,[S(r("input",{type:"range",min:"0",max:"360","onUpdate:modelValue":e[0]||(e[0]=l=>d.h=l),class:"w-full h-3 rounded-full appearance-none cursor-pointer",style:{background:"linear-gradient(to right, hsl(0, 100%, 50%), hsl(60, 100%, 50%), hsl(120, 100%, 50%), hsl(180, 100%, 50%), hsl(240, 100%, 50%), hsl(300, 100%, 50%), hsl(360, 100%, 50%))"},onInput:e[1]||(e[1]=(...l)=>u(M)&&u(M)(...l))},null,544),[[z,d.h]])]),r("div",{class:p(u(v)("relative w-full h-2 rounded-full",a.colorClasses.opacityWrapper))},[S(r("input",{type:"range",min:"0",max:"100","onUpdate:modelValue":e[2]||(e[2]=l=>g.value=l),class:"w-full h-3 appearance-none cursor-pointer",style:B({background:`linear-gradient(to right, transparent, ${Z.value})`}),onInput:e[3]||(e[3]=(...l)=>u(M)&&u(M)(...l))},null,36),[[z,g.value]])],2)])]),r("div",ie,[r("div",ce,[r("input",{type:"text",value:I.value,onChange:e[4]||(e[4]=l=>L(l.target.value)),class:p(u(v)("px-1 w-full text-center text-sm py-px border rounded",a.colorClasses.input))},null,42,pe),e[9]||(e[9]=r("label",{class:"absolute -top-1.5 left-1 font-bold text-xs leading-none"},"Hex",-1))]),r("div",ve,[(m(!0),f(G,null,X(Object.keys(w.value),l=>(m(),f("div",{key:l,class:"relative"},[S(r("input",{type:"number",min:"0",max:"255","onUpdate:modelValue":o=>w.value[l]=o,onInput:O,class:p(u(v)("w-9 text-sm py-px px-px text-center outline-none border rounded",a.colorClasses.input))},null,42,he),[[z,w.value[l]]]),r("label",ge,Y(l.toUpperCase()),1)]))),128)),r("div",me,[S(r("input",{type:"number",min:"0",max:"100","onUpdate:modelValue":e[5]||(e[5]=l=>g.value=l),onInput:O,class:p(u(v)("w-9 text-sm py-px px-px text-center outline-none border rounded",a.colorClasses.input))},null,34),[[z,g.value]]),e[10]||(e[10]=r("label",{class:"absolute -top-1.5 left-1 font-bold text-xs leading-none"},"A",-1))])])]),u(H)?(m(),f("div",fe,[r("h3",be,"Palette - "+Y(x.value),1),r("div",xe,[(m(!0),f(G,null,X(u(H).colors.value,l=>(m(),f("div",{key:l,class:"w-7 h-7 rounded-lg cursor-pointer relative group",style:B({backgroundColor:l}),onClick:o=>L(l)},[r("button",{onClick:q(o=>u(H).remove(l),["stop"]),class:p(u(v)("absolute -top-1 -right-1 grid place-items-center p-px rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-500",a.colorClasses.paletteRemove))},e[11]||(e[11]=[r("svg",{class:"size-3",viewBox:"0 0 512 512"},[r("path",{fill:"currentColor",d:"m289.94 256l95-95A24 24 0 0 0 351 127l-95 95l-95-95a24 24 0 0 0-34 34l95 95l-95 95a24 24 0 1 0 34 34l95-95l95 95a24 24 0 0 0 34-34Z"})],-1)]),10,we)],12,ye))),128)),u(H).colors.value.length<16?(m(),f("button",{key:0,onClick:e[6]||(e[6]=l=>u(H).add(I.value)),class:p(u(v)("w-7 h-7 rounded-lg flex items-center justify-center",a.colorClasses.paletteAdd))},e[12]||(e[12]=[r("svg",{width:"1em",height:"1em",viewBox:"0 0 20 20"},[r("g",{fill:"currentColor"},[r("path",{d:"M5 11a1 1 0 1 1 0-2h10a1 1 0 1 1 0 2z"}),r("path",{d:"M9 5a1 1 0 0 1 2 0v10a1 1 0 1 1-2 0z"})])],-1)]),2)):A("",!0)])])):A("",!0)],34)}}});export{Me as default};
